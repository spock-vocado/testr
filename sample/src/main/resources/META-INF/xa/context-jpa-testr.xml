<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:jee="http://www.springframework.org/schema/jee"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
           http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-3.0.xsd">


    <!-- See http://docs.codehaus.org/display/BTM/JdbcConfiguration2x -->

    <bean id="testrJdbcDataSource"
          class="bitronix.tm.resource.jdbc.PoolingDataSource"
          init-method="init"
          destroy-method="close">
        <property name="className" value="com.mysql.jdbc.jdbc2.optional.MysqlXADataSource"/>
        <property name="uniqueName" value="testr"/>
        <property name="allowLocalTransactions" value="true"/>
        <property name="testQuery" value="select 1"/>
        <property name="maxPoolSize" value="5"/>
        <property name="isolationLevel" value="READ_COMMITTED"/>
        <property name="driverProperties">
            <props>
                <prop key="user">root</prop>
                <prop key="password"></prop>
                <prop key="URL">jdbc:mysql://localhost:3306/testr</prop>
            </props>
        </property>
    </bean>

    <bean id="testrEntityManagerFactory"
          class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean"
          depends-on="transactionManager">
        <property name="dataSource" ref="testrJdbcDataSource"/>
        <property name="persistenceXmlLocation" value="classpath:META-INF/persistence.testr.xml"/>
        <property name="persistenceUnitName" value="testrPu"/>
        <property name="jpaVendorAdapter">
            <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
                <property name="generateDdl" value="true"/>
                <property name="database" value="MYSQL"/>
            </bean>
        </property>
    </bean>

</beans>